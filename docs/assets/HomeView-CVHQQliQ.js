import{d as G,u as I,r as M,c as ee,s as P,a as k,o as d,n as J,b as V,e as t,t as N,_ as q,f as te,g as e,h as le,F,i as O,j as K,w as ne,k as j,v as se,l as H,m as ae}from"./index-DN1Ik6vw.js";import{u as oe,M as W,a as U,b as v,i as ie,c as ue}from"./main-zKkoysYu.js";const re=G({__name:"BoardCell",props:{row:{type:Number,required:!0},col:{type:Number,required:!0}},setup(h,{expose:x}){const _=I("cell");oe({target:_});const m=M(""),f=M(!1),a=M(!1),i=M(!1),o={none:"",flag:"🚩",maybe:"?"},u=M(o.none),p=ee(()=>i.value||u.value===o.maybe?u:m.value==="0"?"":m.value===W.toString()?"💣":m);x({open:c,marked:C,reset:y});const w=U(),{cellClicked:E,toggleFlag:D,incrementFlag:$,decrementFlag:R}=w,{isTouchDevice:r,selectedEmulationButton:s,gameOver:n}=P(w);function c(b){if(!i.value)return a.value?!1:(u.value=o.none,m.value=b.toString(),a.value=!0,!0)}function C(){switch(u.value){case o.flag:$(),u.value=o.maybe,i.value=!1;break;case o.maybe:u.value=o.none;break;default:R(),u.value=o.flag,i.value=!0;break}return i.value}function y(){m.value="",a.value=!1,i.value=!1,u.value=o.none}function l(b){if(n.value)return;const{start:B,end:T,cancel:L}=b.detail;if(B){g(b);return}if(T){S(b);return}if(L){S(b,!0);return}}function g(b){const{button:B}=b.detail;B===v.left&&!a.value&&!i.value&&(f.value=!0)}function S(b,B=!1){const{button:T,longPress:L}=b.detail;if(T===v.left&&(f.value=!1),B)return;let A=T;const Z=s.value!==v.left,z=T===v.left;switch(Z&&z&&r.value&&(A=s.value),z&&L&&r.value&&(A=v.right),A){case v.left:Q();break;case v.right:Y();break;case v.middle:break}}function Q(){a.value||i.value||E(h.row,h.col)}function Y(){a.value||D(h.row,h.col)}return(b,B)=>(d(),k("button",{"on:pointerClick":l,class:V([{open:a.value,mined:m.value===t(W).toString()&&a.value,pressed:f.value},"cell"]),style:J(`--cell-color: var(--cell-color-${m.value});`),type:"button",tabindex:"-1",ref_key:"cell",ref:_},N(p.value),39))}}),ce=q(re,[["__scopeId","data-v-b440c1f9"]]),de={class:"board"},me={class:"bar"},fe={class:"counter",title:"Количество оставшихся флажков"},ve={class:"counter__value"},_e={class:"timer",title:"Таймер"},pe={class:"timer__value"},ge={key:0,class:"emulation-control"},be={class:"emulation-control__inner"},ye={id:"winnerDialog",class:"dialog",ref:"dialog"},ke={class:"dialog__inner"},xe=G({__name:"GameBoard",setup(h){const x=U(),{toggleDisplayOfSettings:_,setCellsRef:m,setDialogRef:f,restartGame:a,addWinner:i,changeDevice:o,changeEmulationButton:u}=x,{selectedMode:p,flagsAvailable:w,timer:E,won:D,gameOver:$,isTouchDevice:R,selectedEmulationButton:r}=P(x),s=I("cellRef"),n=I("dialog"),c=I("dialogInput");function C(){n.value&&(n.value.close(),c.value&&i(c.value.value))}return te(()=>{a(),s.value&&m(s.value),f(n.value,c.value),o(ie())}),(y,l)=>(d(),k("div",de,[e("div",me,[e("p",fe,[l[4]||(l[4]=e("span",{class:"counter__icon"},"🚩",-1)),e("span",ve,N(t(w)),1)]),e("button",{onClick:l[0]||(l[0]=(...g)=>t(a)&&t(a)(...g)),class:"restart",title:"Перезапуск"},l[5]||(l[5]=[e("span",{class:"restart__icon"},"🔄",-1)])),e("button",{onClick:l[1]||(l[1]=(...g)=>t(_)&&t(_)(...g)),class:"settings",title:"Настройки"},l[6]||(l[6]=[e("span",{class:"settings__icon"},"⚙️",-1)])),e("p",_e,[l[7]||(l[7]=e("span",{class:"timer__icon"},"⏱️",-1)),e("span",pe,N(t(E)),1)])]),e("div",{class:V([{defeat:t($)&&!t(D),win:t(D)},"cells"]),style:J(`--columns: ${t(p).cols}`)},[(d(!0),k(F,null,O(t(p).rows,g=>(d(),k(F,{key:g},[(d(!0),k(F,null,O(t(p).cols,S=>(d(),K(ce,{key:t(ue)(g,S,t(p).cols),row:g,col:S,ref_for:!0,ref:"cellRef"},null,8,["row","col"]))),128))],64))),128))],6),t(R)?(d(),k("div",ge,[e("div",be,[e("button",{onClick:l[2]||(l[2]=g=>t(u)(t(v).left)),class:V([{"emulation-button--selected":t(r)===t(v).left},"emulation-control__left emulation-button"]),type:"button",title:"Отключить эмуляцию"},null,2),e("button",{onClick:l[3]||(l[3]=g=>t(u)(t(v).right)),class:V([{"emulation-button--selected":t(r)===t(v).right},"emulation-control__right emulation-button"]),type:"button",title:"Эмуляция правой кнопки мыши"},null,2)]),l[8]||(l[8]=e("p",{class:"emulation-control__label"},"Эмуляция кнопок мыши",-1))])):le("",!0),e("dialog",ye,[l[10]||(l[10]=e("p",{class:"dialog__text"},"Вы победили!",-1)),e("div",ke,[l[9]||(l[9]=e("label",{for:"name"},"Введите имя:",-1)),e("input",{onKeyup:ne(C,["enter"]),type:"text",name:"name",id:"name",class:"dialog__input",ref:"dialogInput"},null,544),e("button",{onClick:C,type:"button",class:"dialog__button"},"OK")])],512)]))}}),Ce=q(xe,[["__scopeId","data-v-1a52c205"]]),Me={class:"settings"},he={class:"modes"},we={class:"modes__list"},De={class:"mode"},$e=["id","checked","value"],Be=["for"],Ee=["disabled"],Re=["onUpdate:modelValue","min","max"],X="custom",Se=.8,Te=G({__name:"GameSettings",setup(h){const x=U(),{modes:_,startGame:m}=x,{selectedMode:f}=P(x),a=M(f.value.name),i=M(f.value.rows),o=M(f.value.cols),u=M(f.value.mines),p=[{name:"rows",label:"Высота",model:i,min:8,max:16},{name:"cols",label:"Ширина",model:o,min:8,max:32},{name:"mines",label:"Мины",model:u,min:10,max:100}];function w(){const r=_.find(s=>s.name===a.value);r&&(i.value=r.rows,o.value=r.cols,u.value=r.mines)}function E(r){/\d/.test(r.key)||r.preventDefault()}function D(r){r.inputType==="insertFromPaste"&&r.preventDefault()}function $(){if(a.value===X){const r=_.find(y=>y.name===a.value),s=p.find(y=>y.name==="rows"),n=p.find(y=>y.name==="cols"),c=p.find(y=>y.name==="mines"),C=Math.round(i.value*o.value*Se);r&&s&&n&&c&&(i.value<s.min?i.value=s.min:i.value>s.max&&(i.value=s.max),o.value<n.min?o.value=n.min:o.value>n.max&&(o.value=n.max),u.value<c.min?u.value=c.min:u.value>C&&(u.value=C))}}function R(){$(),m({mode:a.value,rows:i.value,cols:o.value,mines:u.value})}return(r,s)=>(d(),k("div",Me,[e("section",he,[s[1]||(s[1]=e("h2",{class:"modes__title"},"Уровень сложности",-1)),e("ul",we,[(d(!0),k(F,null,O(t(_),n=>(d(),k("li",De,[j(e("input",{"onUpdate:modelValue":s[0]||(s[0]=c=>a.value=c),id:n.name,checked:n.name===t(f).name,value:n.name,onChange:w,name:"mode",type:"radio",class:"mode__input"},null,40,$e),[[se,a.value]]),e("label",{for:n.name,class:"mode__label"},N(n.label),9,Be)]))),256))]),e("fieldset",{class:"modes__details details",disabled:a.value!==X},[(d(),k(F,null,O(p,(n,c)=>e("label",{key:c,class:"details__label"},[H(N(n.label),1),j(e("input",{"onUpdate:modelValue":C=>n.model.value=C,onKeypress:E,onBeforeinput:D,onFocusout:$,class:"details__input",type:"number",min:n.min,max:n.max},null,40,Re),[[ae,n.model.value,void 0,{number:!0}]])])),64))],8,Ee)]),e("button",{onClick:R,class:"play"},s[2]||(s[2]=[e("span",{class:"play__icon"},"🎮",-1),H("Играть")]))]))}}),Fe=q(Te,[["__scopeId","data-v-ec512d1b"]]),Ve=G({__name:"HomeView",setup(h){const x=U(),{settingsAreDisplayed:_}=P(x);return(m,f)=>t(_)?(d(),K(Fe,{key:1})):(d(),K(Ce,{key:0}))}});export{Ve as default};
